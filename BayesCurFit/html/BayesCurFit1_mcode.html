<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T1U3">p</span>=BayesCurFit(<span class="var type1" id="S3T2U6">x</span>, <span class="var type1" id="S4T2U7">t</span>, <span class="var type1" id="S5T3U8">N</span>, <span class="var type1" id="S6T1U9">x_new</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2"> 2</a></span><span class="line"><span class="mxinfo " id="T1:U6"><span class="var type1" id="S7T1U12">a</span> = <span class="mxinfo " id="T1:U8">0.005</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo " id="T1:U9"><span class="var type1" id="S8T1U16">b</span> = <span class="mxinfo " id="T1:U11">11.1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo " id="T4:U12"><span class="var type1" id="S9T4U20">phi_t</span>=<span class="mxinfo " id="T4:U14">zeros(<span class="var type1" id="S5T3U23">N</span>,<span class="var type1" id="S5T3U24">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5"> 5</a></span><span class="line"><span class="comment">% p=zeros(1,N);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo " id="T4:U17"><span class="var type1" id="S11T4U27">phi_sum</span> = <span class="mxinfo " id="T4:U19">zeros(<span class="var type1" id="S5T3U30">N</span>,<span class="var type1" id="S5T3U31">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo " id="T4:U22"><span class="var type1" id="S12T4U34">s_inv</span> = <span class="mxinfo " id="T4:U24">zeros(<span class="var type1" id="S5T3U37">N</span>,<span class="var type1" id="S5T3U38">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo " id="T5:U27"><span class="var type1" id="S13T5U41">I</span> = <span class="mxinfo " id="T5:U29">eye(5)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo " id="T4:U30"><span class="var type1" id="S15T4U47">s_2</span> = <span class="mxinfo " id="T4:U32">zeros(<span class="var type1" id="S5T3U50">N</span>,<span class="var type1" id="S5T3U51">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo " id="T4:U35"><span class="var type1" id="S16T4U54">tmp_m</span> = <span class="mxinfo " id="T4:U37">zeros(<span class="var type1" id="S5T3U57">N</span>,<span class="var type1" id="S5T3U58">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo " id="T6:U40"><span class="var type1" id="S17T6U61">phi_new_t</span> = <span class="mxinfo " id="T6:U42">zeros(<span class="mxinfo " id="T1:U43">1</span>,<span class="var type1" id="S5T3U65">N</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12">12</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S18T3U68">i</span>=<span class="mxinfo " id="T3:U46">1</span>:<span class="mxinfo " id="T3:U47">1</span>:<span class="var type1" id="S5T3U73">N</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13">13</a></span><span class="line">    <span class="mxinfo " id="T6:U49"><span class="mxinfo " id="T6:U50"><span class="var type1" id="S9T4U77">phi_t</span>(<span class="var type1" id="S18T3U78">i</span>,<span class="mxinfo " id="T7:U53"><span class="mxinfo " id="T3:U54">1</span>:<span class="var type1" id="S5T3U81">N</span></span>)</span>=<span class="mxinfo " id="T8:U56"><span class="var type1" id="S3T2U83">x</span>.^<span class="var type1" id="S18T3U84">i</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14">14</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo " id="T4:U59"><span class="var type1" id="S19T4U87">phi</span> = <span class="mxinfo " id="T4:U61"><span class="var type1" id="S9T4U89">phi_t</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16">16</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S18T3U92">i</span>=<span class="mxinfo " id="T3:U64">1</span>:<span class="mxinfo " id="T3:U65">1</span>:<span class="var type1" id="S5T3U97">N</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo " id="T4:U67"><span class="var type1" id="S20T4U100">tmp</span>=<span class="mxinfo " id="T4:U69"><span class="mxinfo " id="T9:U70"><span class="var type1" id="S19T4U103">phi</span>(<span class="mxinfo " id="T7:U72"><span class="mxinfo " id="T3:U73">1</span>:<span class="var type1" id="S5T3U106">N</span></span>,<span class="var type1" id="S18T3U107">i</span>)</span>*<span class="mxinfo " id="T6:U76"><span class="var type1" id="S9T4U109">phi_t</span>(<span class="var type1" id="S18T3U110">i</span>,<span class="mxinfo " id="T7:U79"><span class="mxinfo " id="T3:U80">1</span>:<span class="var type1" id="S5T3U113">N</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18">18</a></span><span class="line">    <span class="mxinfo " id="T4:U82"><span class="var type1" id="S11T4U116">phi_sum</span> = <span class="mxinfo " id="T4:U84"><span class="var type1" id="S11T4U118">phi_sum</span> + <span class="var type1" id="S20T4U119">tmp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19">19</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo " id="T4:U87"><span class="var type1" id="S12T4U122">s_inv</span> = <span class="mxinfo " id="T5:U89"><span class="mxinfo " id="T5:U90"><span class="var type1" id="S7T1U125">a</span>*<span class="var type1" id="S13T5U126">I</span></span> + <span class="mxinfo " id="T4:U93"><span class="var type1" id="S8T1U128">b</span>*<span class="var type1" id="S11T4U129">phi_sum</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo " id="T10:U96"><span class="var type1" id="S21T10U132">s</span> = <span class="mxinfo " id="T10:U98">inv(<span class="var type1" id="S12T4U135">s_inv</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22">22</a></span><span class="line"><span class="comment">% test new value</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23">23</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S18T3U138">i</span>=<span class="mxinfo " id="T3:U101">1</span>:<span class="mxinfo " id="T3:U102">1</span>:<span class="var type1" id="S5T3U143">N</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24">24</a></span><span class="line">	<span class="mxinfo " id="T1:U104"><span class="mxinfo " id="T1:U105"><span class="var type1" id="S17T6U147">phi_new_t</span>(<span class="mxinfo " id="T1:U107">1</span>,<span class="var type1" id="S18T3U149">i</span>)</span> = <span class="mxinfo " id="T3:U109"><span class="var type1" id="S6T1U151">x_new</span>^<span class="var type1" id="S18T3U152">i</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25">25</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo " id="T9:U112"><span class="var type1" id="S23T9U155">phi_new</span> = <span class="mxinfo " id="T9:U114"><span class="var type1" id="S17T6U157">phi_new_t</span>'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27">27</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28">28</a></span><span class="line"><span class="mxinfo " id="T4:U116"><span class="var type1" id="S15T4U160">s_2</span> = <span class="mxinfo " id="T1:U118"><span class="mxinfo " id="T1:U119"><span class="var type1" id="S8T1U163">b</span>^(-1)</span> + <span class="mxinfo " id="T1:U121"><span class="mxinfo " id="T6:U122"><span class="var type1" id="S17T6U169">phi_new_t</span>*<span class="var type1" id="S21T10U170">s</span></span>*<span class="var type1" id="S23T9U171">phi_new</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29">29</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S18T3U174">i</span>=<span class="mxinfo " id="T3:U127">1</span>:<span class="mxinfo " id="T3:U128">1</span>:<span class="var type1" id="S5T3U179">N</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30">30</a></span><span class="line">    <span class="mxinfo " id="T4:U130"><span class="var type1" id="S20T4U182">tmp</span> = <span class="mxinfo " id="T4:U132"><span class="mxinfo " id="T9:U133"><span class="var type1" id="S19T4U185">phi</span>(<span class="mxinfo " id="T7:U135"><span class="mxinfo " id="T3:U136">1</span>:<span class="var type1" id="S5T3U188">N</span></span>,<span class="var type1" id="S18T3U189">i</span>)</span>*<span class="mxinfo " id="T2:U139"><span class="var type1" id="S4T2U191">t</span>(<span class="mxinfo " id="T11:U141">1</span>,<span class="mxinfo " id="T8:U142"><span class="mxinfo " id="T3:U143">1</span>:<span class="var type1" id="S5T3U195">N</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31">31</a></span><span class="line">    <span class="mxinfo " id="T4:U145"><span class="var type1" id="S16T4U198">tmp_m</span> = <span class="mxinfo " id="T12:U147"><span class="var type1" id="S16T4U200">tmp_m</span> + <span class="var type1" id="S20T4U201">tmp</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32">32</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33">33</a></span><span class="line"><span class="mxinfo " id="T6:U150"><span class="var type1" id="S24T6U204">m</span> = <span class="mxinfo " id="T6:U152"><span class="mxinfo " id="T6:U153"><span class="mxinfo " id="T6:U154"><span class="var type1" id="S8T1U208">b</span>*<span class="var type1" id="S17T6U209">phi_new_t</span></span>*<span class="var type1" id="S21T10U210">s</span></span>*<span class="var type1" id="S16T4U211">tmp_m</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34">34</a></span><span class="line"><span class="mxinfo " id="T13:U159"><span class="var type1" id="S25T13U214">result</span>=<span class="mxinfo " id="T13:U161">pdf(<span class="string">'norm'</span>,<span class="var type1" id="S24T6U218">m</span>,<span class="var type1" id="S15T4U219">s_2</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35">35</a></span><span class="line"><span class="mxinfo " id="T1:U164"><span class="var type1" id="S2T1U222">p</span>=<span class="mxinfo " id="T1:U166"><span class="var type1" id="S25T13U224">result</span>(<span class="var type1" id="S6T1U225">x_new</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36">36</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
